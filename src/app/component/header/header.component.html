<header class="text-white text-center py-2">
  <div class="card rounded-5 rounded-top-0 shadow">
    <div class="card-body">
      <nav class="navbar navbar-expand-lg bg-body-secondary-emphasis h5">
        <a
          class="navbar-brand btn btn-outline-secondary me-2"
          [routerLink]="['/dashboard']"
          >{{ title }}</a
        >
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <ul class="navbar-nav me-auto mb-2 mb-lg-0">
            <li class="nav-item">
              <a
                class="nav-link btn btn-outline-light me-2"
                aria-current="page"
                [routerLink]="['/dashboard']"
                >Home</a
              >
            </li>
            <li class="nav-item dropdown">
              <a
                class="nav-link dropdown-toggle btn btn-outline-light me-2"
                role="button"
                data-bs-toggle="dropdown"
                aria-expanded="false"
                >Opciones</a
              >
              <ul class="dropdown-menu">
                <li>
                  <a class="dropdown-item" [routerLink]="['/contacts']"
                    >Contactos</a
                  >
                </li>
                <li>
                  <a class="dropdown-item" [routerLink]="['/contacts']"
                    >Comentarios</a
                  >
                </li>
              </ul>
            </li>
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="60"
              height="50"
              fill="currentColor"
              class="bi bi-box-seam-fill"
              viewBox="0 0 16 16"
              style="position: relative; left: 80px; top: 5px"
            >
              <path
                fill-rule="evenodd"
                d="M15.528 2.973a.75.75 0 0 1 .472.696v8.662a.75.75 0 0 1-.472.696l-7.25 2.9a.75.75 0 0 1-.557 0l-7.25-2.9A.75.75 0 0 1 0 12.331V3.669a.75.75 0 0 1 .471-.696L7.443.184l.01-.003.268-.108a.75.75 0 0 1 .558 0l.269.108.01.003zM10.404 2 4.25 4.461 1.846 3.5 1 3.839v.4l6.5 2.6v7.922l.5.2.5-.2V6.84l6.5-2.6v-.4l-.846-.339L8 5.961 5.596 5l6.154-2.461z"
              />
            </svg>
          </ul>

          <form class="d-flex">
            <input
              class="form-control me-2"
              type="search"
              minlength="1"
              maxlength="50"
              placeholder="Search"
              aria-label="Search"
            />
            <button class="btn btn-outline-success" type="submit">
              Buscar
            </button>
          </form>

          <button
            class="btn btn-outline-primary ms-2"
            type="button"
            data-bs-toggle="offcanvas"
            data-bs-target="#offcanvasRight"
            aria-controls="offcanvasRight"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="16"
              height="16"
              fill="currentColor"
              class="bi bi-cart3"
              viewBox="0 0 16 16"
            >
              <path
                d="M0 1.5A.5.5 0 0 1 .5 1H2a.5.5 0 0 1 .485.379L2.89 3H14.5a.5.5 0 0 1 .49.598l-1 5a.5.5 0 0 1-.465.401l-9.397.472L4.415 11H13a.5.5 0 0 1 0 1H4a.5.5 0 0 1-.491-.408L2.01 3.607 1.61 2H.5a.5.5 0 0 1-.5-.5M3.102 4l.84 4.479 9.144-.459L13.89 4zM5 12a2 2 0 1 0 0 4 2 2 0 0 0 0-4m7 0a2 2 0 1 0 0 4 2 2 0 0 0 0-4m-7 1a1 1 0 1 1 0 2 1 1 0 0 1 0-2m7 0a1 1 0 1 1 0 2 1 1 0 0 1 0-2"
              />
            </svg>
            Carrito
            <span class="badge bg-secondary">{{ cartItemCount }}</span>
          </button>

          <ng-container *ngIf="!isLoggedIn; else loggedInTemplate">
            <button
              class="btn btn-outline-light ms-2"
              (click)="login()"
              type="button"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="16"
                height="16"
                fill="currentColor"
                class="bi bi-person-fill"
                viewBox="0 0 16 16"
              >
                <path
                  d="M3 14s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1zm5-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6"
                />
              </svg>
              Iniciar sesión
            </button>
          </ng-container>
          <ng-template #loggedInTemplate>
            <button
              class="btn btn-outline-light ms-2"
              (click)="confirmLogout()"
              type="button"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="16"
                height="16"
                fill="currentColor"
                class="bi bi-person-fill"
                viewBox="0 0 16 16"
              >
                <path
                  d="M3 14s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1zm5-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6"
                />
              </svg>
              Bienvenido/a {{ name }}
            </button>
          </ng-template>
        </div>
      </nav>
    </div>
  </div>
</header>

<!-- offcanvas -->
<div
  class="offcanvas offcanvas-end"
  tabindex="-1"
  id="offcanvasRight"
  aria-labelledby="offcanvasRightLabel"
>
  <div class="offcanvas-header">
    <h5 class="offcanvas-title" id="offcanvasRightLabel">
      <svg
        xmlns="http://www.w3.org/2000/svg"
        width="16"
        height="16"
        fill="currentColor"
        class="bi bi-cart3"
        viewBox="0 0 16 16"
      >
        <path
          d="M0 1.5A.5.5 0 0 1 .5 1H2a.5.5 0 0 1 .485.379L2.89 3H14.5a.5.5 0 0 1 .49.598l-1 5a.5.5 0 0 1-.465.401l-9.397.472L4.415 11H13a.5.5 0 0 1 0 1H4a.5.5 0 0 1-.491-.408L2.01 3.607 1.61 2H.5a.5.5 0 0 1-.5-.5M3.102 4l.84 4.479 9.144-.459L13.89 4zM5 12a2 2 0 1 0 0 4 2 2 0 0 0 0-4m7 0a2 2 0 1 0 0 4 2 2 0 0 0 0-4m-7 1a1 1 0 1 1 0 2 1 1 0 0 1 0-2m7 0a1 1 0 1 1 0 2 1 1 0 0 1 0-2"
        />
      </svg>
      Carrito de Compras
    </h5>
    <button
      type="button"
      class="btn-close"
      data-bs-dismiss="offcanvas"
      aria-label="Close"
    ></button>
  </div>
  <div class="offcanvas-body">
    <div *ngFor="let item of cartService.getCart(); let i = index">
      <div class="d-flex align-items-center mb-3">
        <img
          [src]="item.images[0]"
          alt="{{ item.name }}"
          class="img-thumbnail mr-2"
          style="width: 50px"
        />
        <div
          class="d-flex align-items-center flex-grow-1 justify-content-between"
        >
          <div class="flex-grow-1">
            <p class="mb-0">{{ item.name }}</p>
            <p class="mb-0">
              Cantidad:
              <select
                class="form-select form-select-sm me-2"
                [(ngModel)]="item.quantity"
                (change)="updateCartItem(item)"
              >
                <option *ngFor="let qty of quantities" [value]="qty">
                  {{ qty }}
                </option>
              </select>
            </p>
          </div>
          <button
            class="btn btn-danger btn-sm ms-2"
            (click)="confirmDelete(item)"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="16"
              height="16"
              fill="currentColor"
              class="bi bi-trash"
              viewBox="0 0 16 16"
            >
              <path
                d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0z"
              />
              <path
                d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4zM2.5 3h11V2h-11z"
              />
            </svg>
          </button>
        </div>
      </div>
    </div>

    <!-- Botón "Procesar Compra" -->
    <button
      *ngIf="cartService.getCart().length > 0"
      class="btn btn-primary"
      (click)="procesarCompra()"
    >
      Procesar Compra
    </button>
  </div>
</div>
